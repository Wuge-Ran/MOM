<!--pages/course/book/index.wxml-->
<!--pages/course/index.wxml-->
<view class="contaioner">
  <view class="header">
    <image class="header-bg" src="/assets/images/course-bg.png" />
  </view>

  <view class="notification" wx:if="{{cancelBookDisabledStr}}">
    <image class="notification-icon" src="/assets/icons/message.png" />
    <span class="message">{{cancelBookDisabledStr}}</span>
  </view>

  <view class="course-detail">
    <span class="title">{{course.display_name}}</span>
    <span class="book-info">{{bookStr}}</span>
    <view class="coach-info" bind:tap="onCoachTap" data-id="{{course.coach_id}}">
      <image class="coach-avatar" src="{{course.coach_avatar_url || avatarUrl}}" shape="round"></image>
      <view class="coach-info-right" bind:tap="onCoachTap" data-id="{{course.coach_id}}">
        <span class="coach-name">{{course.coach_nickname}}</span>
        <span class="ohter-coach">点击查看教练其他课程</span>
        <image class="arrow-right" src="/assets/icons/arrow-right.png"></image>
      </view>
    </view>
    <view class="time-info flex-row">
      <image class="icon-time icon" src="/assets/icons/clock.png"></image>
      <span class="time">{{timeRangeStr}}</span>
    </view>
    <view class="address-info flex-row">
      <view class="flex-row">
        <image class="icon-address icon" src="/assets/icons/address.png"></image>
        <span class="address">{{course.address}}</span>
      </view>
      <view wx:if="{{course.address_lat!=0 && course.address_long!=0}}"  class="map-info flex-row" bind:tap="onMapTap">
        <image class="icon-map icon" src="/assets/icons/address1.png"></image>
        <span class="map-title" >导航</span>
      </view>
    </view>
    <view class="course-desc">
      <view class="course-desc-title">课程介绍</view>
      <view class="course-desc-detail">{{course.description}}</view>
    </view>
  </view>

  <view class="bottom-contaioner display-absolute">
    <button class="btn cancel-btn btn-borde-rnone {{status.cancel.disabled?'btn-disabled':''}}" wx:if="{{status.cancel.visible}}" disabled="{{status.cancel.disabled}}" bind:tap="onCancelTap">{{status.cancel.text}}</button>
    <button class="btn confirm-btn btn-borde-rnone {{status.confirm.disabled?'btn-disabled':''}}" wx:if="{{status.confirm.visible}}" disabled="{{status.confirm.disabled}}" bind:tap="onConfirmTap">{{status.confirm.text}}</button>
  </view>

  <!-- 购卡或预约底部弹窗 -->
  <t-popup visible="{{showPurchaseUI}}" bind:visible-change="onConfromUIVisiableChange" placement="bottom">
    <view class="reconfrom-container">
      <view class="reconfrom-body">
        <span class="title">{{course.display_name}}</span>
        <view class="flex-row time-info1">
          <image class="icon-time icon" src="/assets/icons/clock.png"></image>
          <span class="time">{{timeRangeStr}}</span>
        </view>
        <view class="flex-row">
          <image class="icon" src="/assets/icons/coach.png"></image>
          <span>{{course.coach_nickname}}</span>
        </view>
        <view class="flex-row address-info1">
          <image class="icon-address icon" src="/assets/icons/address.png"></image>
          <span class="address">{{course.address}}</span>
        </view>
        <view wx:if="{{cards.length>0}}" class="buy-info">
          <view class="flex-row">
            <span>选择会员卡</span>
            <view wx:if="{{choosedCard}}" class="choose-card bottom-arrow" bind:tap="onChooseCardTap">{{choosedCard.label}}</view>
          </view>
          <view class="flex-row remark-info">
            <span>备注</span>
            <t-input maxlength="{{50}}" align="right" value="{{remark}}" placeholder="备注信息仅教练可见">
            </t-input>
          </view>
        </view>
        <span wx:else class="no-card">抱歉，您暂无可使用的课程卡，请购卡。</span>
      </view>
      <view class="bottom-contaioner confirm-bottom-contaioner">
        <button class="btn confirm-btn btn-borde-rnone" bind:tap="onConfirmTap1">{{reConfirmBuyStr}}</button>
      </view>
    </view>
  </t-popup>

  <!-- 取消候补或取消预约二次确认弹窗 -->
  <t-dialog class="dialog" visible="{{showDialogConfirm}}" title="{{status.cancel.text}}" confirm-btn="{{dialogConfirmBtn}}" cancel-btn="取消" bind:confirm="onReconfirmTap" bind:cancel="closeDialog">
    <view slot="content">
      <view class="dialog-content-container">
        <span>取消候补后将释放您的预约名额，课程卡将退回账户</span>
      </view>
    </view>
  </t-dialog>


    <!-- 选择会员卡 -->
  <t-picker visible="{{cardsChooseUIVisible}}" value="{{[choosedCard.value]}}" data-key="id" cancelBtn="取消" confirmBtn="确认" bindchange="onPickerChange" bindpick="onColumnChange" bindclose="onPickerClose">
              <t-picker-item options="{{cards}}"></t-picker-item>
  </t-picker>

</view>

<t-toast id="t-toast" />